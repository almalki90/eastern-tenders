name: ğŸ¤– Ø§Ù„Ø¨ÙˆØª Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠ 24/7

on:
  # ØªØ´ØºÙŠÙ„ ÙŠØ¯ÙˆÙŠ
  workflow_dispatch:
  
  # ØªØ´ØºÙŠÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙƒÙ„ 5 Ø¯Ù‚Ø§Ø¦Ù‚ (Ù„Ø¥Ø¨Ù‚Ø§Ø¡ Ø§Ù„Ø¨ÙˆØª Ø­ÙŠ)
  schedule:
    - cron: '*/5 * * * *'  # ÙƒÙ„ 5 Ø¯Ù‚Ø§Ø¦Ù‚
  
  # ØªØ´ØºÙŠÙ„ Ø¹Ù†Ø¯ push Ù„Ù„ÙƒÙˆØ¯
  push:
    branches:
      - main
    paths:
      - 'decor-bot.js'
      - 'multi-source-service.js'
      - 'unsplash-service.js'
      - 'pexels-service.js'

jobs:
  run-interactive-bot:
    runs-on: ubuntu-latest
    timeout-minutes: 5  # ÙƒÙ„ ØªØ´ØºÙŠÙ„ ÙŠØ³ØªÙ…Ø± 5 Ø¯Ù‚Ø§Ø¦Ù‚ ÙÙ‚Ø·
    
    steps:
      - name: ğŸ“¥ Checkout Repository
        uses: actions/checkout@v4
      
      - name: ğŸŸ¢ Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'
      
      - name: ğŸ“¦ Install Dependencies
        run: npm install --production
      
      - name: ğŸ¤– Run Interactive Bot (5 min)
        env:
          TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
          UNSPLASH_ACCESS_KEY: ${{ secrets.UNSPLASH_ACCESS_KEY }}
          UNSPLASH_SECRET_KEY: ${{ secrets.UNSPLASH_SECRET_KEY }}
          PEXELS_API_KEY: ${{ secrets.PEXELS_API_KEY }}
        run: |
          echo "ğŸ¤– Ø¨Ø¯Ø¡ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØª Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠ..."
          echo "â±ï¸ Ø³ÙŠØ¹Ù…Ù„ Ù„Ù…Ø¯Ø© 5 Ø¯Ù‚Ø§Ø¦Ù‚ Ø«Ù… ÙŠØ¹ÙŠØ¯ Ø§Ù„ØªØ´ØºÙŠÙ„"
          
          # ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØª Ù…Ø¹ timeout 4 Ø¯Ù‚Ø§Ø¦Ù‚ Ùˆ 50 Ø«Ø§Ù†ÙŠØ©
          timeout 290s node decor-bot.js || true
          
          echo "âœ… Ø§Ù†ØªÙ‡Ù‰ ÙˆÙ‚Øª Ø§Ù„ØªØ´ØºÙŠÙ„ - Ø³ÙŠØ¨Ø¯Ø£ Ù…Ù† Ø¬Ø¯ÙŠØ¯ Ø¨Ø¹Ø¯ 5 Ø¯Ù‚Ø§Ø¦Ù‚"
